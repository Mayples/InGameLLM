<Ui xmlns="http://www.blizzard.com/wow/ui/">
  <!-- Virtual Template MUST COME FIRST -->
  <Button name="ResultTemplate" virtual="true" hidden="true">
    <Size x="400" y="20"/>
    <Layers>
      <Layer level="BACKGROUND">
        <Texture name="$parentIcon" parentKey="Icon">
          <Size x="16" y="16"/>
          <Anchors>
            <Anchor point="LEFT"/>
          </Anchors>
        </Texture>
      </Layer>
      <Layer level="OVERLAY">
        <FontString name="$parentText" inherits="GameFontNormal" parentKey="Text">
          <Anchors>
            <Anchor point="LEFT" relativeTo="$parentIcon" relativePoint="RIGHT" x="5"/>
          </Anchors>
        </FontString>
      </Layer>
    </Layers>
    <Scripts>
      <OnClick>
        if self.data and self.data.response then
          StaticPopup_Show("InGameLLM_DetailPopup", nil, nil, {text = self.data.response})
        end
      </OnClick>
    </Scripts>
  </Button>

  <!-- Main Frame -->
  <Frame name="InGameLLMFrame" parent="UIParent" enableMouse="true" movable="true">
    <Size x="450" y="350"/>
    <Anchors>
      <Anchor point="CENTER"/>
    </Anchors>
    <Scripts>
      <OnLoad>
        InGameLLM_OnLoad(self)
      </OnLoad>
    </Scripts>
    <Frames>
      <!-- Input Box -->
      <EditBox name="InputBox" inherits="InputBoxTemplate" autoFocus="false">
        <Size x="400" y="20"/>
        <Anchors>
          <Anchor point="TOPLEFT" relativePoint="TOPLEFT" x="25" y="-20"/>
        </Anchors>
        <Scripts>
          <OnTextChanged>
            InGameLLM_ProcessQuery(self:GetText())
          </OnTextChanged>
          <OnEnterPressed>
            self:ClearFocus()
          </OnEnterPressed>
        </Scripts>
      </EditBox>
      
      <!-- Results Scroll Frame -->
      <ScrollFrame name="OutputFrame" inherits="UIPanelScrollFrameTemplate">
        <Size x="400" y="300"/>
        <Anchors>
          <Anchor point="TOPLEFT" relativeTo="InputBox" relativePoint="BOTTOMLEFT" x="0" y="-10"/>
        </Anchors>
        <ScrollChild>
          <Frame name="OutputContainer">
            <Size x="400" y="300"/>
          </Frame>
        </ScrollChild>
      </ScrollFrame>
    </Frames>
  </Frame>
</Ui>